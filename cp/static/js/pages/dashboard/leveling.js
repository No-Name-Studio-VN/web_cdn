(async()=>{const n=$("#channels_exempted"),t=$("#roles_exempted"),a=$("#level_up_announcement_channel"),l=$("#level_up_announcement_delete_after_holder"),o=$("#level_up_announcement_type"),r=$("#disable_pro_members_xp_boost"),d=$("#xp_rate_holder"),c=$("#toggle_module"),s=$("[name='level_up_announcement_message']"),i=$(".roles_select"),p=$(".channels_select");var e=window.location.pathname;var _=e.split("/")[2];try{(await DiscordAPIHandler.getChannels(_,{channelType:"GuildText"})).forEach(e=>{p.append(new Option(e.name,e.id))}),(await DiscordAPIHandler.getRoles(_)).forEach(e=>{i.append(new Option(e.name,e.id))})}catch(e){console.error(e),NotificationHandler.show({content:"An error occurred while fetching guild data.",type:"danger"})}await 0,o.on("change",function(){3==$(this).val()?a.prop("disabled",!1):a.prop("disabled",!0)}),$.get(e+"/data",e=>{e=e.data;c.removeClass("btn-success btn-danger btn-primary").attr("disabled",!1).attr("data-tggle",e.enabled?"disable":"enable").addClass(e.enabled?"btn-danger":"btn-success").text(i18next.t(e.enabled?"disabled":"enabled")),window.ContentHandler.createLabelSlider(l,{id:"level_up_announcement_delete_after",value:e.level_up_announcement_delete_after,min:0,max:180,step:15}),s.val(e.level_up_announcement_message);window.ContentHandler.createLabelSlider(d,{id:"xp_rate",value:e.xp_rate,min:.25,max:4,step:.25}),r.prop("checked",e.disable_pro_members_xp_boost),$("#channel_type_"+e.noxp.channel_type).prop("checked",!0),$("#role_type_"+e.noxp.role_type).prop("checked",!0),o.val(e.level_up_announcement_type).trigger("change"),a.val(e.level_up_announcement_channel).trigger("change"),n.val(e.noxp.channels_exempted).trigger("change"),t.val(e.noxp.roles_exempted).trigger("change"),window.ContentHandler.ToggleMultiSelect(n,{placeholder:"Select channels"}),window.ContentHandler.ToggleMultiSelect(t,{placeholder:"Select roles"}),FormHandler.InitializeFormWatcher(),window.ContentHandler.ToggleMainContent("#main",!0)});const m=document.getElementById("togglemodal");m&&m.addEventListener("show.bs.modal",e=>{e=e.relatedTarget;m.querySelector(".modal-footer").innerHTML=`
            <button type="button" class="btn btn-dark" data-bs-dismiss="modal">${i18next.t("dashboard.cancel")}</button>
            <button class="btn btn-primary" type="submit" name="${e.getAttribute("data-tggle")}">${i18next.t("dashboard.apply")}</button>
            `})})();